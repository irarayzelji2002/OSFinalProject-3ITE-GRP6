<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CPU Scheduling</title>

  <!--Bootstrap CSS CDN-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="site.css">
  <!--Google Font-Roboto-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
  <!--FONT AWESOME-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
  <a href="index.html" class="btn btn-light exit" style="text-decoration:none; color:#262626; border-radius:50%; position:absolute; transform: translate(50%,-60%); z-index:1;">
    <i class="fa-solid fa-house" style="color:#262626; margin-top:8px; margin-bottom:8px;"></i>
  </a>
  
  <div class="my-5">
    <h2 class="text-center title" style="color:white; filter: drop-shadow(0 2mm 4mm rgb(0, 0, 0));">CPU Scheduling</h2>
    <h5 class="text-center" style="color:white; filter: drop-shadow(0 2mm 4mm rgb(0, 0, 0)); font-weight:600;">Algo Name</h5>
  </div>

  <div class="row justify-content-center align-items-center g-0 mb-5">
    <div class="card col-lg-5 col-sm-8">
      <div class="content-holder">
        <div class="mb-3 content" id="content-1" data-id='1'>
          <label for="currentPosition" class="form-label">Input current position</label>
          <span class="errorSpan errCurrentPosition"></span>
          <input type="text" class="form-control" id="currentPosition" style="margin-bottom:10px;">

          <label for="trackSize" class="form-label">Input track size</label>
          <span class="errorSpan errTrackSize"></span>
          <input type="text" class="form-control" id="trackSize" style="margin-bottom:10px;">

          <label for="seekRate" class="form-label">Input seek rate</label>
          <span class="errorSpan errSeekRate"></span>
          <input type="text" class="form-control" id="seekRate" style="margin-bottom:10px;">

          <label for="noOfRequest" class="form-label">Input number of request (Max of 10)</label>
          <span class="errorSpan errNoOfRequest"></span>
          <input type="text" class="form-control" id="noOfRequest" style="margin-bottom:30px;">
        </div>
        
        <div class="mb-3 content" id="content-2" data-id='2'>
          <label for="arrivalTime" class="form-label">Input individual arrival time</label>
          <div id="newFieldsRequest"></div>
        </div>
        
        <div class="mb-3 content" id="content-3" data-id='3'>
          <label for="alpha" class="form-label">Input alpha</label>
          <span class="errorSpan errAlpha"></span>
          <input type="text" class="form-control" id="alpha" style="margin-bottom:30px;">
        </div>
        <button type="button" class="btn btn-secondary back" style="float:left;">Back</button>
        <button type="button" class="btn btn-secondary next" style="float:right;">Next</button>
      </div>

      <div class="end" id="content-end" data-id='4' style="text-align:center;">
        <div id="newFieldsResult" class="table-responsive" style="margin-bottom:20px;"></div>
        <button type="button" class="btn btn-secondary retry">Retry</button>
        <a href="index.html" class="btn btn-secondary exit" style="text-decoration:none; color:#262626;">Exit</a>
      </div>
    </div>
  </div>

  <!--Bootstrap JavaScript CDN-->
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
  <script>   
    var counter = 1;
    $('.back').hide();
    $('#content-2').hide();
    $('#content-3').hide();
    $('.end').hide();
    console.log('counter is '+counter)
    var currentPosition;
    var trackSize;
    var seekRate;
    var noOfRequest;
    var alpha;
    var requests = [];
    var errRequestsCount = 0;
    $('body').on('click', '.next', function() { 
        $('.content').hide();
        var newFieldsRequest;

        //VALIDATE BEFORE GOING TO NEXT
        if(counter==1) {
          $('#content-1').show();
          currentPosition = document.getElementById('currentPosition').value;
          var errCurrentPosition = $('#currentPosition').parent().find('.errCurrentPosition');
          trackSize = document.getElementById('trackSize').value;
          var errTrackSize = $('#trackSize').parent().find('.errTrackSize');
          seekRate = document.getElementById('seekRate').value;
          var errSeekRate = $('#seekRate').parent().find('.errSeekRate');
          noOfRequest = document.getElementById('noOfRequest').value;
          var errNoOfRequest = $('#noOfRequest').parent().find('.errNoOfRequest');
          var errCount= 0;
        
          if(currentPosition=="") {
            errCurrentPosition.text('This field is required');
            errCount++;
          } else if (isNaN(currentPosition)) {
            errCurrentPosition.text('Must be a number');
            errCount++;
          }

          if(trackSize=="") {
            errTrackSize.text('This field is required');
            errCount++;
          } else if (isNaN(trackSize)) {
            errTrackSize.text('Must be a number');
            errCount++;
          }

          if(seekRate=="") {
            errSeekRate.text('This field is required');
            errCount++;
          } else if (isNaN(seekRate)) {
            errSeekRate.text('Must be a number');
            errCount++;
          }

          if(noOfRequest=="") {
            errNoOfRequest.text('This field is required');
            errCount++;
          } else if((noOfRequest%1 != 0) || noOfRequest>10) {
            errNoOfRequest.text('Must be less than integer 10');
            errCount++;
          }

          if(errCount == 0){ //correct info
            counter++;
            $('#content-1').hide();
            $('#content-2').show();
            $('.back').show();
            addFieldsRequest(noOfRequest);
          }
        } else if(counter==2) {
          $('#content-2').show();
          $('.back').show();
          
          validateRequest();
          
        } else if(counter==3) {
          $('#content-3').show();
          $('.back').show();

          alpha = document.getElementById('alpha').value;
          var errAlpha = $('#alpha').parent().find('.errAlpha');
          if(alpha=="") {
            errAlpha.text('This field is required');
          } else if (isNaN(alpha)) {
            errAlpha.text('Must be a number');
          } else {
            counter++;
            $('#content-3').hide();
            $('.content-holder').hide();
            $('.end').show();
            $('.next').removeClass("btn-info");
            $('.next').addClass("btn-secondary");
            document.querySelector('.next').innerText = 'Next';
            noOfRequest = parseInt(document.getElementById('noOfRequest').value);
            console.log(noOfRequest)
            addFieldsResult(noOfRequest);
          }
        }
        
        //CPU SCHEDULING COMPUTATION & RESULT
        if(counter > 3) {
          $('.content-holder').hide();
          $('.end').show();
          var card = document.querySelector('.card')
          card.classList.remove('col-lg-5');
          card.classList.remove('col-sm-8');
          card.classList.add('col-10');
        };
    });

    $('body').on('click', '.back', function() { 
      counter--;
      console.log('counter: '+counter);
      $('.content').hide();
      if(counter<2) {
        $('#content-1').show();
        $('.back').hide();
        removeFieldsRequest();
      } else if(counter==2) {
        $('#content-2').show();
      } else if(counter==3) {
        $('#content-3').show();
      }

      if(counter<3){
        $('.next').removeClass("btn-info")
        $('.next').addClass("btn-secondary")
        document.querySelector('.next').innerText = 'Next'
      }
    });

    $('body').on('click', '.retry', function() { 
      $('.back').hide();
      $('.end').hide();
      $('.content-holder').show();
      $('#content-1').show();
      $('.next').removeClass("btn-info")
      $('.next').addClass("btn-secondary")
      document.querySelector('.next').innerText = 'Next'
      document.getElementById('currentPosition').value = ""
      document.getElementById('trackSize').value = ""
      document.getElementById('seekRate').value = ""
      document.getElementById('noOfRequest').value = ""
      document.getElementById('alpha').value = ""
      document.querySelector('.errCurrentPosition').innerHTML = ""
      document.querySelector('.errTrackSize').innerHTML = ""
      document.querySelector('.errSeekRate').innerHTML = ""
      document.querySelector('.errNoOfRequest').innerHTML = ""
      document.querySelector('.errAlpha').innerHTML = ""
      removeFieldsRequest();
      removeFieldsResult();
      counter = 1
    });

    var n = document.getElementById('noOfRequest').value;
    console.log('n is '+n)
    var label = $('<label for="request" class="form-label"></label>');
    var span = $('<span class="errorSpan"></span>');
    var input = $('<input type="text" class="form-control" style="margin-bottom:10px;"/>');
    newFieldsRequest = $('');
    //ADDING, REMOVING, VALIDATING AT FIELDS
    function addFieldsRequest(n) {
      for (i = newFieldsRequest.length; i < n; i++) {
        label = $('<label for="request" class="form-label">Loc'+(i+1)+'</label>');
        span = $('<span class="errorSpan errorSpanRequest'+(i+1)+'"></span>');
        input = $('<input type="text" class="form-control" style="margin-bottom:10px;" id="request'+(i+1)+'"/>');
        var newLabel = label.clone();
        var newSpan = span.clone();
        var newInput = input.clone();
        newFieldsRequest = newFieldsRequest.add(newLabel);
        newFieldsRequest = newFieldsRequest.add(newSpan);
        newFieldsRequest = newFieldsRequest.add(newInput);
        newLabel.appendTo('#newFieldsRequest');
        newSpan.appendTo('#newFieldsRequest');
        newInput.appendTo('#newFieldsRequest');
      }
    }

    function removeFieldsRequest() {
      var removeField = newFieldsRequest.slice(0).remove();
      newFieldsRequest = newFieldsRequest.not(removeField);
    }

    function validateRequest() {
      var n = ((newFieldsRequest.length)/3)
      console.log('is empty: '+requests==[])
      errRequestsCount = 0;
      if(requests==[]) {
        console.log('here')
        requests = [n+1];
      }
      
      for (i = 0; i < n ; i++) {
        requests[i] = document.getElementById('request'+(i+1)).value;
        var errorSpan = $('#request'+(i+1)).parent().find('.errorSpanRequest'+(i+1));
        if(requests[i]=="") {
          errorSpan.text('This field is required');
          errRequestsCount++;
        } else if(isNaN(requests[i]+"")){
          errorSpan.text('Must be a number');
          errRequestsCount++;
        } else {
          errorSpan.text('');
        }
      }

      if(errRequestsCount == 0){ //correct info
        counter++;
        $('#content-2').hide();
        $('#content-3').show();
        $('.next').removeClass("btn-secondary");
        $('.next').addClass("btn-info");
        document.querySelector('.next').innerText = 'Submit';

        /*
        counter++;
        $('#content-3').hide();
        $('.content-holder').hide();
        $('.end').show();
        $('.next').removeClass("btn-info");
        $('.next').addClass("btn-secondary");
        document.querySelector('.next').innerText = 'Next';
        addFieldsResult(n);
        */
      }

      console.log(requests)
      console.log('errRequestsCount: '+errRequestsCount)
    }

    //COMPUTE & ADD TABLE
    function addFieldsResult(n) {
      const div = document.getElementById("newFieldsResult"),
      tbl = document.createElement('table');
      tbl.classList.add('table');
      tbl.classList.add('table-hover');
      tbl.classList.add('table-light');
      tbl.style.borderRadius = '20px';
      tbl.style.marginBottom = '0';
      var thead;
      var tbody = tbl.createTBody();
      var tfoot;
      var tr;
      console.log('no of requests: '+n)
      console.log('requests: '+requests)
      console.log('current position: '+currentPosition)
      console.log('track size: '+trackSize)
      console.log('seek rate: '+seekRate)
      console.log('alpha: '+alpha)
      for (let i = 0; i < 2; i++) {
        if(i === 0) {
          thead = tbl.createTHead();
          tr = thead.insertRow();
        }
        if (i != 0 && i < n+1) {
          tr = tbody.insertRow();
        }
        
        for (let j = 0; j < 2; j++) {
          if (i < n+1) {
            const td = tr.insertCell();
            td.style.color = 'black';
            if (i === 0 && j === 0) {
              td.appendChild(document.createTextNode(`Total Head Movement`));
              td.style.fontWeight = '600';
              td.style.borderTop = '0';
            } else if (i === 0 && j === 1) {
              td.appendChild(document.createTextNode(`Seek Time`));
              td.style.fontWeight = '600';
              td.style.borderTop = '0';
            } else if (j === 0) {
              td.appendChild(document.createTextNode(`Total Head Movement I${i}/J${j}`)); //compute total head movement here
            } else if (j === 1) {
              td.appendChild(document.createTextNode(`Seek Time I${i}/J${j}`)); //compute seek time here
            } else {
              td.appendChild(document.createTextNode(`Cell I${i}/J${j}`));
            }
          }
        }
      }
      div.appendChild(tbl);
    }
    function removeFieldsResult() {
      var newFieldsResult = document.getElementById('newFieldsResult')
      newFieldsResult.innerHTML = '';
    }
  </script>
</body>
</html>